<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>DoV - COMMAND V68 (GLOBAL MONITOR)</title>
    <style>
        /* DESIGN V43 PERFECT ALIGN - STRICTEMENT INCHANGÃ‰ */
        :root { 
            --main: #00e676; --alert: #ff1744; --sec: #29b6f6; --warn: #ff9800; --dovx: #9c27b0; 
            --gold: #ffd700; --money: #2ecc71;
            --fuel: #e67e22; --health: #e74c3c; --repair: #bdc3c7; --supply: #f1c40f;
            --bg: #050505; --panel: #111; 
        }
        body { background-color: var(--bg); color: #ccc; font-family: 'Consolas', monospace; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        header { height: 40px; background: #000; border-bottom: 1px solid #333; display: flex; align-items: center; padding: 0 15px; justify-content: space-between; }
        h1 { color: var(--gold); margin: 0; font-size: 16px; letter-spacing: 1px; text-transform: uppercase; }
        .rpc-badge { font-size: 10px; background: #222; padding: 2px 6px; border-radius: 4px; border: 1px solid #444; color: #888; }
        .layout { display: flex; flex: 1; overflow: hidden; }
        .sidebar { width: 280px; background: var(--panel); border-right: 1px solid #333; padding: 15px; display: flex; flex-direction: column; gap: 15px; overflow-y: auto; }
        .main-view { flex: 1; padding: 20px; overflow-y: auto; position: relative; background: #000; }
        .box { border: 1px solid #444; padding: 10px; background: #080808; margin-bottom: 10px; }
        .box-title { color: #fff; font-size: 11px; font-weight: bold; margin-bottom: 8px; border-bottom: 1px solid #333; padding-bottom: 4px; }
        button { width: 100%; padding: 10px; cursor: pointer; border: none; font-weight: bold; font-family: monospace; text-transform: uppercase; margin-bottom: 5px; font-size: 11px; }
        .btn-zone { background: var(--main); color: #000; } 
        .btn-eco { background: var(--gold); color: #000; }
        .btn-stop { background: var(--alert); color: #fff; display: none; }
        input { width: 100%; padding: 8px; background: #222; border: 1px solid #444; color: #fff; box-sizing: border-box; font-family: monospace; margin-bottom: 5px; }
        .eco-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px; }
        .eco-card { background: #111; border: 1px solid #333; padding: 15px; border-top: 3px solid #444; min-height: 80px; display: flex; flex-direction: column; justify-content: space-between; }
        .balance-container { background:#111; padding:15px; border:1px solid #333; margin-bottom:20px; }
        .balance-header { display: grid; grid-template-columns: 1fr 1fr 1fr; font-size: 11px; font-weight: bold; margin-bottom: 8px; text-transform: uppercase; }
        .balance-bar { width: 100%; height: 12px; background: #222; display: flex; border-radius: 3px; overflow: hidden; }
        .bal-demand { background: var(--alert); height: 100%; transition: width 0.5s; }
        .bal-supply { background: var(--main); height: 100%; transition: width 0.5s; }
        .matrix-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
        .matrix-col { background: #111; border: 1px solid #333; display: flex; flex-direction: column; }
        .mx-head { padding: 8px; font-weight: bold; text-align: center; color: #000; font-size: 12px; }
        .mx-body { padding: 10px; font-size: 11px; display: flex; flex-direction: column; gap: 8px; flex: 1; }
        .zones-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .zone { background: #0a0a0a; border: 1px solid #333; padding: 8px; min-height: 110px; opacity: 0.6; display: flex; flex-direction: column; justify-content: space-between; }
        .zone.active { opacity: 1; border-color: #444; }
        .logs { height: 120px; background: #000; border-top: 1px solid #333; padding: 10px; font-size: 11px; color: #888; overflow-y: auto; font-family: monospace; white-space: pre-wrap; }
        .view-section { display: none; } .view-active { display: block; }
        .integrity-badge { font-size: 9px; padding: 2px 8px; border-radius: 4px; font-weight: bold; letter-spacing: 0.5px; }
        /* DOVX ANALYSIS STYLES */
        .dovx-breakdown { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-top: 10px; }
        .db-card { background: #080808; border: 1px solid #333; padding: 10px; display: flex; flex-direction: column; justify-content: space-between; height: 80px; }
        .db-head { font-size: 10px; color: #888; text-transform: uppercase; border-bottom: 1px solid #222; padding-bottom: 3px; margin-bottom: 5px; }
        .db-val { font-size: 16px; font-weight: bold; color: #fff; }
        .db-usd { font-size: 11px; color: var(--money); text-align: right; }
        .mx-row { display: flex; justify-content: space-between; border-bottom: 1px solid #222; padding-bottom: 4px; }
        .mx-val { color: #fff; font-weight: bold; }
        .mx-bal { text-align: center; padding: 5px; font-weight: bold; margin-top: 5px; border-radius: 3px; }
        .bal-pos { background: rgba(0, 230, 118, 0.1); color: var(--main); border: 1px solid var(--main); }
        .bal-neg { background: rgba(255, 23, 68, 0.1); color: var(--alert); border: 1px solid var(--alert); }
        .eco-head span:first-child { font-weight:bold; }
        .eco-head span:last-child { font-size:14px; }
    </style>
</head>
<body>

<header>
    <h1>DoV COMMAND <span style="color:var(--sec)">V68 GLOBAL MONITOR</span></h1>
    <span class="rpc-badge" id="rpcStatus">PRÃŠT</span>
</header>

<div class="layout">
    <aside class="sidebar">
        <div class="box" style="border-color: var(--gold)">
            <div class="box-title">CONFIGURATION MARCHÃ‰</div>
            <input type="number" id="inpWax" value="0.00786" step="0.00001" onchange="updateRates()">
            <input type="number" id="inpDovx" value="0.00528553" step="0.00000001" onchange="updateRates()">
            <input type="number" id="inpTu" value="0.00045262" step="0.00000001" onchange="updateRates()">
        </div>
        <div class="box">
            <button class="btn-zone" onclick="startZoneScan()">SCAN ZONES (MAP)</button>
            <div class="box-title" style="margin-top:10px">MONITORING GLOBAL</div>
            <button class="btn-eco" onclick="startEconomyScan()">SCAN PROJET COMPLET</button>
            <button class="btn-stop" id="btnStop" onclick="stopSignal=true">ARRÃŠT D'URGENCE</button>
        </div>
    </aside>

    <main class="main-view">
        <div id="zoneView" class="view-section view-active">
            <div class="zones-grid" id="zonesArea"></div>
        </div>
        <div id="ecoView" class="view-section">
            <div id="integrityContainer" style="text-align:right; margin-bottom:10px"></div>
            
            <div class="eco-grid" id="ecoCards">
                 <div class="eco-card" style="border-top-color:var(--alert)">
                    <div class="eco-head"><span>DEMANDE GLOBALE</span><span>ðŸ”¥</span></div>
                    <div class="eco-val" id="valDemandTU">0 TU</div>
                    <div class="eco-usd" id="valDemandUSD">$0.00</div>
                </div>
                <div class="eco-card" style="border-top-color:var(--main)">
                    <div class="eco-head"><span>OFFRE GLOBALE</span><span>âš¡</span></div>
                    <div class="eco-val" id="valSupplyTU">0 TU</div>
                    <div class="eco-usd" id="valSupplyUSD">$0.00</div>
                </div>
                <div class="eco-card" style="border-top-color:var(--dovx)">
                    <div class="eco-head"><span>SOLDE DOVX PROJET</span><span>ðŸ“‰</span></div>
                    <div class="eco-val" id="valDovxNet">0 DOVX</div>
                    <div class="eco-usd" id="usdDovxNet">$0.00</div>
                </div>
            </div>

            <div class="balance-container">
                <div class="balance-header">
                     <div style="color:var(--alert); text-align:left;">DEMANDE</div>
                     <div style="text-align:center; color:#fff" id="ratioTxt">...</div>
                     <div style="color:var(--main); text-align:right;">OFFRE</div>
                </div>
                <div class="balance-bar">
                    <div class="bal-demand" id="barDemand" style="width:50%"></div>
                    <div class="bal-supply" id="barSupply" style="width:50%"></div>
                </div>
            </div>

            <div class="matrix-grid" id="tokenMatrix"></div>

            <div id="dovxAnalysis" style="background:#111; padding:15px; border:1px solid var(--dovx); margin-top:20px;">
                <div style="font-weight:bold; color:var(--dovx); margin-bottom:10px; text-transform:uppercase;">ANALYSE DOVX (MACRO-Ã‰CONOMIE)</div>
                <div class="dovx-breakdown">
                     <div class="db-card" style="border-color:var(--main)">
                        <div class="db-head" style="color:var(--main)">TOTAL MINT (WIN/DRAW)</div>
                        <div class="db-val" id="valDovxMint">0</div>
                        <div class="db-usd" id="usdDovxMint">$0.00</div>
                    </div>
                    <div class="db-card" style="border-color:var(--alert)">
                        <div class="db-head" style="color:var(--alert)">TOTAL BURN (FIXES)</div>
                        <div class="db-val" id="valDovxBurnTotal">0</div>
                        <div class="db-usd" id="usdDovxBurnTotal">$0.00</div>
                    </div>
                     <div class="db-card" style="border-color:#fff">
                        <div class="db-head" style="color:#fff">NET FLOW</div>
                        <div class="db-val" id="valDovxProfit">0</div>
                        <div class="db-usd" id="usdDovxProfit">$0.00</div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<div class="logs" id="console">> V68 : Initialisation Monitor Global. PrÃªt.</div>

<script>
    let RATES = { WAX_USD: 0.00786, DOVX_WAX: 0.00528553, TU_WAX: 0.00045262 };
    let stopSignal = false;
    let rpcIndex = 0;
    const RPCS = ["https://wax.greymass.com", "https://api.waxsweden.org", "https://wax.eosn.io", "https://api.wax.alohaeos.com"];

    // RÃˆGLES ON-CHAIN
    const DOVX_CLAIM_LEVELS = {
        win:   { minPower: 100, reward: 400.00 }, 
        draw:  { minPower: 60,  reward: 200.00 },
        lost:  { minPower: 1,   reward: 50.00 }
    };

    const ZONE_DB = {
        1: { name: "Beach 1", cost: 1160, costX: 0 },
        2: { name: "Beach 2", cost: 6968, costX: 0 },
        3: { name: "Beach 3", cost: 8800, costX: 0 },
        4: { name: "Bunker", cost: 11120, costX: 0 },
        5: { name: "Forest 1", cost: 14024, costX: 0 },
        6: { name: "Forest 2", cost: 17704, costX: 0 },
        7: { name: "Forest 3", cost: 22352, costX: 0 },
        8: { name: "Camp", cost: 28220, costX: 0 },
        9: { name: "Hill 1", cost: 37052, costX: 0 },
        10: { name: "Hill 2", cost: 48652, costX: 0 },
        11: { name: "Hill 3", cost: 64516, costX: 0 },
        12: { name: "Radar", cost: 84712, costX: 0 },
        13: { name: "Plain 1", cost: 99384, costX: 0 },
        14: { name: "Plain 2", cost: 125708, costX: 0 },
        15: { name: "Plain 3", cost: 151164, costX: 0 },
        16: { name: "HQ", cost: 188000, costX: 0 },
        17: { name: "City 1", cost: 0, costX: 1664 },
        18: { name: "City 2", cost: 0, costX: 4448 },
        19: { name: "City 3", cost: 0, costX: 13440 },
        20: { name: "City 4", cost: 0, costX: 29120 }
    };
    const ZONE_ORDER = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20];

    let ECO_DATA = { 
        demand: { fuel:0, health:0, repair:0, supply:0 }, 
        supply: { fuel:0, health:0, repair:0, supply:0 }, 
        dovx: { rewards:0, burn:0 },
        scanned: { buildings:0, divisions:0 }
    };

    function getDovxClaim(power) {
        if (power >= DOVX_CLAIM_LEVELS.win.minPower) return "win";
        if (power >= DOVX_CLAIM_LEVELS.draw.minPower) return "draw";
        if (power >= DOVX_CLAIM_LEVELS.lost.minPower) return "lost";
        return null;
    }

    // --- MOTEUR DE SCAN "GLOBAL WALKER" (RESILIENT) ---
    async function robustFetchWithRetry(code, table, lowerBound, limit=300) {
        let attempts = 0;
        const maxAttempts = 5;

        while(attempts < maxAttempts && !stopSignal) {
            const server = RPCS[rpcIndex % RPCS.length];
            try {
                // Petit dÃ©lai pour ne pas DDOS les RPC
                if(attempts > 0) await new Promise(r => setTimeout(r, 1000));
                
                document.getElementById('rpcStatus').innerText = "RPC: " + new URL(server).hostname;
                const controller = new AbortController();
                setTimeout(() => controller.abort(), 10000); // 10s timeout

                const res = await fetch(server + "/v1/chain/get_table_rows", {
                    method: 'POST',
                    body: JSON.stringify({ 
                        json: true, code: code, scope: code, table: table, 
                        limit: limit, lower_bound: lowerBound 
                    }),
                    signal: controller.signal
                });
                
                if(!res.ok) throw new Error("HTTP " + res.status);
                return await res.json();

            } catch(e) { 
                rpcIndex++; 
                attempts++;
                // Si tous les RPC Ã©chouent, on attend un peu plus
                if(attempts === maxAttempts) {
                    log("âš ï¸ RÃ©seau instable, pause...", "orange");
                    await new Promise(r => setTimeout(r, 2000));
                    attempts = 0; // On boucle indÃ©finiment en mode Global Monitor
                }
            }
        }
        return null;
    }

    async function startEconomyScan() {
        switchView('ecoView'); stopSignal = false; document.getElementById('btnStop').style.display = 'block';
        
        // Reset Data
        ECO_DATA = { demand: { fuel:0, health:0, repair:0, supply:0 }, supply: { fuel:0, health:0, repair:0, supply:0 }, dovx: { rewards:0, burn:0 }, scanned: { buildings:0, divisions:0 }};
        
        log("DÃ©marrage Monitor Global (Ceci peut Ãªtre long)...", "var(--gold)");

        // 1. SCAN GLOBAL BÃ‚TIMENTS (OFFRE)
        let nextKey = ""; let hasMore = true;
        while(hasMore && !stopSignal) {
            // Pas d'index_position, on scanne par Primary Key (Asset ID)
            const d = await robustFetchWithRetry("dovutilstake", "buildings", nextKey, 300); // 300 limit safe
            
            if(!d || !d.rows) break; // Ne devrait pas arriver avec robustFetchWithRetry sauf arrÃªt
            
            d.rows.forEach(b => {
                let p = Array.isArray(b.power) ? b.power[0] : b.power; 
                let v = parseFloat(p) || 0;
                
                if(p.includes("DOVF")) ECO_DATA.supply.fuel += v;
                else if(p.includes("DOVH")) ECO_DATA.supply.health += v;
                else if(p.includes("DOVR")) ECO_DATA.supply.repair += v;
                else if(p.includes("DOVS")) ECO_DATA.supply.supply += v;
                
                ECO_DATA.scanned.buildings++;
            });

            // Feedback Visuel Progressif
            updateEcoUI(true, "BÃ¢timents");
            
            if(d.more && d.next_key) nextKey = d.next_key; else hasMore = false;
            // Micro pause pour laisser respirer l'UI
            await new Promise(r => setTimeout(r, 20));
        }

        log("BÃ¢timents terminÃ©s. Scan Divisions...", "var(--sec)");

        // 2. SCAN GLOBAL DIVISIONS (DEMANDE)
        nextKey = ""; hasMore = true;
        while(hasMore && !stopSignal) {
            const d = await robustFetchWithRetry("dovpvecontrl", "sdivisions", nextKey, 300);
            
            if(!d || !d.rows) break;

            d.rows.forEach(r => {
                const zid = r.zone_id || r.zoneID;
                const busy = r.end_time > (Date.now()/1000);
                
                if(busy && ZONE_DB[zid]) {
                    const z = ZONE_DB[zid];
                    // CoÃ»ts TU
                    ECO_DATA.demand.fuel += z.cost; ECO_DATA.demand.health += z.cost;
                    ECO_DATA.demand.repair += z.cost; ECO_DATA.demand.supply += z.cost;
                    
                    // CoÃ»ts DOVX (Fixe)
                    ECO_DATA.dovx.burn += z.costX;
                    
                    // Gain DOVX (Variable selon Poids)
                    const power = r.power || r.min_power || 0;
                    const claim = getDovxClaim(power);
                    if(claim) ECO_DATA.dovx.rewards += DOVX_CLAIM_LEVELS[claim].reward;
                }
                ECO_DATA.scanned.divisions++;
            });
            
            updateEcoUI(true, "Divisions");
            if(d.more && d.next_key) nextKey = d.next_key; else hasMore = false;
            await new Promise(r => setTimeout(r, 20));
        }

        log(`MONITORING COMPLET : ${ECO_DATA.scanned.buildings} Usines / ${ECO_DATA.scanned.divisions} Troupes.`, "var(--main)");
        updateEcoUI(false);
        document.getElementById('btnStop').style.display = 'none';
    }

    function updateEcoUI(scanning=false, step="") {
        const fmt = (n) => n.toLocaleString(undefined, {maximumFractionDigits:0});
        const fmtUSD = (n) => "$" + n.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2});

        // UI Updates... (MÃªme logique d'affichage que V67)
        let dTotal = ECO_DATA.demand.fuel + ECO_DATA.demand.health + ECO_DATA.demand.repair + ECO_DATA.demand.supply;
        let sTotal = ECO_DATA.supply.fuel + ECO_DATA.supply.health + ECO_DATA.supply.repair + ECO_DATA.supply.supply;
        
        document.getElementById('valDemandTU').innerText = fmt(dTotal) + " TU";
        document.getElementById('valDemandUSD').innerText = fmtUSD(dTotal * RATES.TU_WAX * RATES.WAX_USD);
        document.getElementById('valSupplyTU').innerText = fmt(sTotal) + " TU";
        document.getElementById('valSupplyUSD').innerText = fmtUSD(sTotal * RATES.TU_WAX * RATES.WAX_USD);

        let total = dTotal + sTotal || 1;
        document.getElementById('barDemand').style.width = ((dTotal/total)*100) + "%";
        document.getElementById('barSupply').style.width = ((sTotal/total)*100) + "%";
        let diff = sTotal - dTotal;
        document.getElementById('ratioTxt').innerHTML = diff >= 0 ? `<span style="color:var(--main)">SURPLUS (+${fmt(diff)})</span>` : `<span style="color:var(--alert)">DÃ‰FICIT (${fmt(diff)})</span>`;

        const tokens = [ { k:'fuel', c:'var(--fuel)' }, { k:'health', c:'var(--health)' }, { k:'repair', c:'var(--repair)' }, { k:'supply', c:'var(--supply)' } ];
        let h = "";
        tokens.forEach(t => {
            let s = ECO_DATA.supply[t.k], d = ECO_DATA.demand[t.k], bal = s-d;
            h += `<div class="matrix-col" style="border-top:3px solid ${t.c}"><div class="mx-head" style="background:${t.c}">${t.k.toUpperCase()}</div><div class="mx-body"><div><div class="mx-row"><span>Prod.</span><span class="mx-val">${fmt(s)}</span></div><div class="mx-row"><span>Besoin</span><span class="mx-val">${fmt(d)}</span></div></div><div class="mx-bal ${bal>=0?'bal-pos':'bal-neg'}">${bal>=0?'SURPLUS':'MANQUE'} ${fmt(bal)}</div></div></div>`;
        });
        document.getElementById('tokenMatrix').innerHTML = h;

        let mint = ECO_DATA.dovx.rewards; let burn = ECO_DATA.dovx.burn; let net = mint - burn;
        document.getElementById('valDovxMint').innerText = "+" + fmt(mint);
        document.getElementById('usdDovxMint').innerText = fmtUSD(mint * RATES.DOVX_WAX * RATES.WAX_USD);
        document.getElementById('valDovxBurnTotal').innerText = "-" + fmt(burn);
        document.getElementById('usdDovxBurnTotal').innerText = fmtUSD(burn * RATES.DOVX_WAX * RATES.WAX_USD);
        let elNet = document.getElementById('valDovxProfit');
        elNet.innerText = (net>=0?"+":"") + fmt(net);
        elNet.style.color = net >= 0 ? "var(--main)" : "var(--alert)";
        document.getElementById('usdDovxProfit').innerText = fmtUSD(net * RATES.DOVX_WAX * RATES.WAX_USD);
        document.getElementById('valDovxNet').innerText = fmt(net);

        let statusText = scanning ? `ðŸ“¡ SCAN GLOBAL (${step}): ${ECO_DATA.scanned.buildings + ECO_DATA.scanned.divisions} items` : `ðŸŸ¢ PROJET ENTIER SCANNÃ‰`;
        document.getElementById('integrityContainer').innerHTML = `<span class="integrity-badge" style="background:#222; color:${scanning?'var(--warn)':'var(--main)'}">${statusText}</span>`;
    }

    function switchView(id) { document.querySelectorAll('.view-section').forEach(v => v.classList.remove('view-active')); document.getElementById(id).classList.add('view-active'); }
    function log(m, c) { const l=document.getElementById('console'); l.innerHTML=`<div style="color:${c}">[${new Date().toLocaleTimeString()}] ${m}</div>`+l.innerHTML; }
    function updateRates() { if(document.getElementById('ecoView').classList.contains('view-active')) updateEcoUI(); }
    
    // SCAN ZONE (IDENTIQUE V43)
    async function startZoneScan() {
        switchView('zoneView'); stopSignal = false; document.getElementById('btnStop').style.display = 'block';
        initGrid();
        let stats = { divs: 0, burn: { fuel: 0, health: 0, repair: 0, supply: 0 }, totalCostX: 0, totalGain: 0, zones: {} };
        ZONE_ORDER.forEach(id => stats.zones[id] = { count: 0, active: 0, idle: 0 });
        let nextKey = ""; let hasMore = true;
        
        while(hasMore && !stopSignal) {
            const data = await robustFetchWithRetry("dovpvecontrl", "sdivisions", nextKey, 300);
            if(!data || !data.rows) break;
            data.rows.forEach(row => {
                stats.divs++;
                const zID = row.zone_id || row.zoneID;
                if(stats.zones[zID]) {
                    stats.zones[zID].count++;
                    if(row.end_time > (Date.now()/1000)) {
                        stats.zones[zID].active++;
                        if(ZONE_DB[zID].cost > 0) {
                             stats.burn.fuel+=ZONE_DB[zID].cost; stats.burn.health+=ZONE_DB[zID].cost;
                             stats.burn.repair+=ZONE_DB[zID].cost; stats.burn.supply+=ZONE_DB[zID].cost;
                        }
                        stats.totalCostX += ZONE_DB[zID].costX;
                        // Gain simple pour la map (non power-based pour affichage rapide)
                        stats.totalGain += 0; // On laisse 0 ou une moyenne car le gain dÃ©pend de la division
                    } else stats.zones[zID].idle++;
                }
            });
            updateZoneDash(stats);
            if(data.more) nextKey = data.next_key; else hasMore = false;
        }
        document.getElementById('btnStop').style.display='none';
    }

    function updateZoneDash(stats) {
        // ... (Code V43 updateZoneDash inchangÃ©)
        document.getElementById('dDivs').innerText = stats.divs.toLocaleString();
        // ...
        ZONE_ORDER.forEach(id => {
            const data = stats.zones[id]; const card = document.getElementById(`z-card-${id}`);
            if(card && data) {
                document.getElementById(`z-count-${id}`).innerText = data.count;
                document.getElementById(`z-miss-${id}`).innerText = data.active + " Act.";
                document.getElementById(`z-rdy-${id}`).innerText = data.idle + " Rdy";
                if(data.count>0) card.classList.add('active');
            }
        });
    }

    function initGrid() {
        const grid = document.getElementById('zonesArea'); grid.innerHTML = "";
        ZONE_ORDER.forEach(id => {
            const z = ZONE_DB[id];
            let costDisplay = z.cost > 0 ? `<span class="z-burn">-${z.cost.toLocaleString()}/TU</span>` : `<span class="z-burn-x">-${z.costX.toLocaleString()} DOVX</span>`;
            grid.innerHTML += `<div class="zone" id="z-card-${id}"><div class="z-head"><span>${z.name}</span><span id="z-count-${id}">0</span></div><div class="z-metrics"><div class="z-row"><span>CoÃ»t:</span> ${costDisplay}</div></div><div class="z-act-text"><span style="color:var(--warn)" id="z-miss-${id}">0 act.</span><span style="color:var(--main)" id="z-rdy-${id}">0 rdy</span></div></div>`;
        });
    }

    initGrid();
</script>
</body>
</html>
