<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>DoV - COMMAND V319 (FULL MAP)</title>
    <style>
        :root {
            --bg-app: #0b0c10; --bg-panel: #13141b; --bg-header: #1c1d26; --border: #2d2e3a;
            --green: #00f090; --red: #ff3b30; --blue: #2979ff; --orange: #ff9100; --purple: #d500f9; --yellow: #ffea00;
            --text-main: #e0e0e0; --text-muted: #858595;
            --font-ui: 'Inter', system-ui, sans-serif; --font-num: 'JetBrains Mono', 'Consolas', monospace; 
        }
        body { background: var(--bg-app); color: var(--text-muted); font-family: var(--font-ui); margin: 0; display: flex; height: 100vh; overflow: hidden; font-size: 11px; }
        * { box-sizing: border-box; }
        ::-webkit-scrollbar { width: 6px; background: var(--bg-app); } ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        .layout { display: flex; width: 100%; height: 100%; }
        .sidebar { width: 280px; background: var(--bg-panel); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 15px; gap: 15px; flex-shrink: 0; z-index: 10; }
        .main-content { flex: 1; overflow-y: auto; padding: 25px; background: linear-gradient(180deg, var(--bg-app) 0%, #08080a 100%); display:flex; flex-direction:column; }
        .app-title { color: #fff; font-weight: 800; font-size: 14px; letter-spacing: 1px; display:flex; align-items:center; gap:8px; margin-bottom: 10px; }
        .status-dot { width: 8px; height: 8px; background: var(--green); border-radius: 50%; box-shadow: 0 0 8px var(--green); }
        .control-group { display: flex; flex-direction: column; gap: 8px; }
        .grp-lbl { font-size: 9px; font-weight: 700; color: #555; text-transform: uppercase; letter-spacing: 0.5px; }
        input { background: #08080a; border: 1px solid #333; color: #fff; padding: 8px; border-radius: 4px; font-family: var(--font-num); width: 100%; }
        button { padding: 9px; border: none; border-radius: 4px; font-weight: 700; font-size: 10px; text-transform: uppercase; cursor: pointer; transition: 0.2s; width: 100%; }
        button:hover { filter: brightness(1.1); transform: translateY(-1px); }
        .btn-green { background: var(--green); color: #000; } .btn-red { background: rgba(255, 59, 48, 0.15); color: var(--red); border: 1px solid rgba(255, 59, 48, 0.3); }
        .btn-blue { background: var(--blue); color: #fff; } .btn-orange { background: var(--orange); color: #000; }
        .btn-purple { background: var(--purple); color: #fff; } .btn-yellow { background: var(--yellow); color: #000; }
        .btn-ghost { background: transparent; border: 1px solid #333; color: #888; }
        .btn-row { display: flex; gap: 8px; }
        .console-log { flex: 1; background: #000; border: 1px solid #333; border-radius: 4px; padding: 10px; font-family: var(--font-num); font-size: 9px; color: #0f0; overflow-y: auto; white-space: pre-wrap; display: flex; flex-direction: column-reverse; max-height: 300px; margin-top: auto; }
        .log-entry { margin-bottom: 2px; border-bottom: 1px solid #111; padding-bottom: 2px; }
        .log-time { color: #555; margin-right: 5px; }
        .dashboard-header { display: flex; justify-content: space-between; align-items: flex-end; padding-bottom: 15px; border-bottom: 1px solid var(--border); margin-bottom: 25px; }
        .page-h1 { font-size: 20px; font-weight: 800; color: #fff; margin: 0; }
        .total-cost { text-align: right; }
        .tc-val { font-family: var(--font-num); font-size: 28px; font-weight: 800; color: var(--purple); text-shadow: 0 0 10px rgba(213, 0, 249, 0.3); } 
        .tc-unit { color: #888; font-size: 12px; font-weight: 700; }
        .kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 25px; }
        .kpi-card { background: var(--bg-panel); border: 1px solid var(--border); border-radius: 6px; padding: 15px; position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: space-between; min-height: 180px; }
        .kpi-card::before { content:''; position: absolute; left: 0; top: 0; bottom: 0; width: 4px; }
        .kc-title { font-size: 10px; font-weight: 700; color: #888; text-transform: uppercase; }
        .kc-val { font-family: var(--font-num); font-size: 20px; font-weight: 700; color: #fff; margin-top: 2px; }
        .kc-val-huge { font-family: var(--font-num); font-size: 26px; font-weight: 800; color: #fff; margin-top: 2px; letter-spacing: -1px; }
        .kc-sub { font-size: 10px; color: #666; font-family: var(--font-num); margin-top: auto; }
        .kc-sep { height:1px; background:rgba(255,255,255,0.1); margin:8px 0; }
        .fuel .kpi-card::before { background: var(--orange); } .fuel .kc-val, .fuel .kc-val-huge { color: var(--orange); } 
        .health .kpi-card::before { background: var(--red); } .health .kc-val, .health .kc-val-huge { color: var(--red); } 
        .repair .kpi-card::before { background: var(--blue); } .repair .kc-val, .repair .kc-val-huge { color: var(--blue); } 
        .supply .kpi-card::before { background: var(--yellow); } .supply .kc-val, .supply .kc-val-huge { color: var(--yellow); } 
        .eco .kpi-card::before { background: #fff; }
        .pie-container { display: flex; align-items: center; justify-content: center; height: 100%; }
        .pie-chart { width: 80px; height: 80px; border-radius: 50%; background: conic-gradient(var(--green) 0% 0%, #333 0% 100%); display: flex; align-items: center; justify-content: center; position: relative; }
        .pie-chart::after { content: ''; position: absolute; width: 60px; height: 60px; background: var(--bg-panel); border-radius: 50%; }
        .pie-val { position: absolute; z-index: 2; font-family: var(--font-num); font-weight: 700; color: #fff; font-size: 14px; }
        .tables-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-items: start; }
        .data-panel { background: var(--bg-panel); border: 1px solid var(--border); border-radius: 6px; display: flex; flex-direction: column; }
        .dp-head { padding: 10px 15px; background: var(--bg-header); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .dp-title { font-weight: 800; font-size: 11px; color: #fff; text-transform: uppercase; }
        .dp-badges { display: flex; gap: 8px; font-family: var(--font-num); font-size: 10px; }
        .dt-grid { display: grid; grid-template-columns: minmax(140px, 2fr) 50px 70px 90px 90px 90px 70px 70px; }
        .dt-header { padding: 8px 12px; font-size: 9px; font-weight: 700; color: #666; text-transform: uppercase; border-bottom: 1px solid var(--border); background: rgba(0,0,0,0.2); }
        .dt-row { padding: 6px 12px; border-bottom: 1px solid rgba(255,255,255,0.03); font-size: 11px; align-items: center; color: #ccc; transition: 0.1s; }
        .dt-row:hover { background: rgba(255,255,255,0.05); color: #fff; }
        .cell { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .c-right { text-align: right; justify-content: flex-end; }
        .c-center { text-align: center; justify-content: center; }
        .zones-map { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
        .zone-card { background: var(--bg-panel); border: 1px solid var(--border); padding: 10px; border-radius: 4px; display: flex; flex-direction: column; justify-content: space-between; height: 160px; cursor: pointer; transition: 0.2s; }
        .zone-card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); border-color: var(--blue); }
        .zone-card.active { border-color: var(--blue); background: rgba(41, 121, 255, 0.05); }
        .zc-top { display: flex; justify-content: space-between; font-weight: 700; color: #fff; font-size: 11px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 4px; margin-bottom: 6px;}
        .zc-mid { display: flex; flex-direction: column; gap: 4px; flex: 1; }
        .zs-item { display: flex; justify-content: space-between; font-family: var(--font-num); font-size: 9px; color: #888; }
        .zc-bot { display: flex; justify-content: space-between; font-size: 10px; font-family: var(--font-num); border-top: 1px solid rgba(255,255,255,0.05); padding-top:4px; margin-top: auto; }
        .tc-f { color: var(--orange); } .tc-h { color: var(--red); } .tc-r { color: var(--blue); } .tc-s { color: var(--yellow); }
        .view-section { display: none; } .active-view { display: block; }
        a.atomic { color: inherit; text-decoration: none; border-bottom: 1px dotted #444; }
        a.atomic:hover { color: var(--blue); border-bottom-color: var(--blue); }
        .modal-overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:999; justify-content:center; align-items:center; }
        .modal-box { width:650px; background:var(--bg-panel); border:1px solid var(--border); padding:20px; border-radius:6px; box-shadow:0 20px 50px #000; max-height:90vh; overflow-y:auto; }
        .market-ticker { display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px; margin-bottom: 20px; }
        .ticker-item { background: #191a21; border: 1px solid #333; padding: 10px; border-radius: 4px; text-align: center; }
        .t-sym { font-weight: 800; color: #fff; font-size: 12px; }
        .t-price { font-family: var(--font-num); color: var(--blue); font-size: 11px; margin-top: 4px; }
        .t-usd { font-family: var(--font-num); color: #666; font-size: 10px; }
        .acc-btn { cursor:pointer; font-weight:bold; color:var(--blue); }
        .acc-content { display:none; background:#08080a; padding:10px; border-left:2px solid var(--blue); margin-top:5px; grid-column: 1 / -1; }
        .val-row { display: flex; justify-content: space-between; font-size: 10px; color: #888; border-bottom: 1px dotted #333; padding: 2px 0; }
        .val-row span:last-child { color: #fff; font-family: var(--font-num); }
        #error-banner { display:none; background:var(--red); color:#fff; padding:10px; text-align:center; position:fixed; top:0; left:0; width:100%; z-index:9999; font-weight:bold; }
        .dr-section { margin-bottom: 20px; border-bottom: 1px solid #222; padding-bottom: 20px; }
        .dr-title { color: var(--blue); font-size: 12px; font-weight: bold; margin-bottom: 10px; text-transform: uppercase; }
        .dr-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .dr-item { background: #000; padding: 10px; border: 1px solid #333; border-radius: 4px; font-size: 11px; display: flex; justify-content: space-between; align-items: center; }
        .dr-item a { color: #fff; text-decoration: none; } .dr-item a:hover { color: var(--blue); }
        .dr-logo { width: 100px; height: 100px; border-radius: 50%; border: 2px solid #333; margin: 0 auto 20px auto; display: block; object-fit: cover; }
        .sys-clock { font-family:var(--font-num); color:var(--orange); font-size:11px; margin-left:auto; display:flex; gap:10px; align-items:center; border:1px solid #333; padding:5px 10px; border-radius:4px; background:#000; }
        .clock-copy { opacity:0.7; }
        #chartContainer { width:100%; height:280px; background:#08080a; border:1px solid #333; border-radius:4px; margin-bottom:15px; position:relative; }
        canvas { display:block; width:100%; height:100%; }
        .stats-table-wrapper { max-height:300px; overflow-y:auto; }
        .chart-controls { display:flex; gap:10px; margin-bottom:10px; }
        .chart-btn { padding:5px 10px; border:1px solid #444; background:#111; color:#888; font-size:10px; cursor:pointer; border-radius:4px; }
        .chart-btn.active { background:var(--blue); color:#fff; border-color:var(--blue); }
        .analysis-box { background:rgba(41,121,255,0.1); border-left:3px solid var(--blue); padding:10px; color:#ccc; font-size:11px; margin-bottom:15px; font-family:var(--font-ui); }
        .sim-grid { display:grid; grid-template-columns: 1fr 1fr; gap:20px; }
        .sim-result { background:var(--bg-panel); border:1px solid var(--border); padding:15px; border-radius:6px; margin-top:20px; text-align:center; }
        .rec-box { margin-top:10px; font-size:14px; font-weight:bold; color:var(--yellow); padding:10px; border:1px dashed var(--yellow); border-radius:4px; }
        .gap-row { display:flex; justify-content:space-between; padding:5px 0; border-bottom:1px solid #333; color:#ccc; }
        .gap-val { font-family:var(--font-num); font-weight:bold; }
        .val-red { color:var(--red); } .val-green { color:var(--green); }
        /* NOUVEAUX STYLES POUR LES BADGES */
        .badge-req { font-size:9px; padding:2px 4px; border-radius:3px; background:rgba(213,0,249,0.15); border:1px solid var(--purple); color:var(--purple); display:inline-block; margin-right:4px; font-family:var(--font-num); }
        .badge-weight { font-size:9px; padding:2px 4px; border-radius:3px; background:rgba(41, 121, 255, 0.1); border:1px solid var(--blue); color:var(--blue); display:inline-block; font-family:var(--font-num); }
        .badge-offline { font-size:9px; padding:2px 4px; border-radius:3px; background:rgba(255,59,48,0.15); border:1px solid var(--red); color:var(--red); display:inline-block; font-family:var(--font-num); }
    </style>
</head>
<body>
<div id="error-banner"></div>
<div class="layout">
    <aside class="sidebar">
        <div class="app-title"><div class="status-dot"></div> DOV COMMAND <span style="opacity:0.5; font-weight:400;">V319</span></div>
        <div class="control-group">
            <span class="grp-lbl">OPERATIONS</span>
            <div class="btn-row"><button class="btn-green" onclick="dispatchGlobalScan()">BÂTIMENTS</button></div>
            <div class="btn-row"><button class="btn-blue" onclick="startZoneScan()">DIVISIONS</button><button class="btn-orange" onclick="startEconomyScan()">ECONOMY</button></div>
            <div class="btn-row"><button class="btn-purple" onclick="showStatsView()">STATISTICS</button></div>
            <div class="btn-row"><button class="btn-yellow" onclick="showSimView()">WAR ROOM</button></div>
        </div>
        
        <div class="control-group">
            <span class="grp-lbl">PROJECT INTELLIGENCE</span>
            <button class="btn-ghost" style="color:#fff; border-color:#555;" onclick="openDataRoom()">DATA ROOM</button>
        </div>

        <div class="control-group">
            <span class="grp-lbl">BLACK BOX LOGGING</span>
            <div class="btn-row">
                <button class="btn-purple" onclick="takeLogSnapshot(true)">FORCE SNAPSHOT</button>
                <button class="btn-ghost" style="color:#fff" onclick="exportLogs()">EXPORT CSV</button>
            </div>
            <button class="btn-red" style="margin-top:8px;" onclick="openAuditView()">AUDIT INACTIFS ⚠️</button>
        </div>

        <div class="control-group"><span class="grp-lbl">TARGET INTELLIGENCE</span><input type="text" id="targetIn" value="u2d2k.c.wam"><div class="btn-row"><button class="btn-ghost" style="color:#fff">DIVISIONS</button><button class="btn-ghost" style="color:#fff">BUILDINGS</button></div></div>
        <div class="control-group" style="margin-top:auto">
            <div style="display:flex; justify-content:space-between; font-size:10px; color:#666;"><span>DB</span> <span id="dictSize" style="color:#fff">0</span></div>
            <button class="btn-ghost" style="color:var(--red); border-color:var(--red);" onclick="hardReset()">FACTORY RESET</button>
        </div>
        <div class="console-log" id="sysLog"><div class="log-entry"><span class="log-time">SYS:</span>V319. Blockchain Sync Active.</div></div>
    </aside>

    <main class="main-content">
        <div id="viewGlobal" class="view-section active-view">
            <div class="dashboard-header">
                <div><h2 class="page-h1">PRODUCTION BÂTIMENTS</h2><div class="page-meta">ROWS: <span id="cntRows">0</span></div></div>
                <div class="sys-clock"><span id="liveTime">00:00:00</span> <span style="color:#666">|</span> <span id="liveDate">YYYY-MM-DD</span></div>
                <div class="total-cost"><div class="grp-lbl">MAINTENANCE DOVX / 24H</div><div><span class="tc-val" id="gTotalCost">0</span></div></div>
            </div>
            <div class="kpi-grid" id="areaCards"></div><div class="tables-grid" id="areaLists"></div>
        </div>

        <div id="viewZones" class="view-section">
            <div class="dashboard-header" style="border-left: 4px solid var(--blue)">
                <div><h2 class="page-h1">CARTE DIVISIONS</h2><div class="page-meta">UNITS: <span id="zTotalDivsHeader">0</span></div></div>
                <div class="sys-clock"><span class="clock-copy"></span></div>
                <div class="total-cost">
                    <div class="grp-lbl">CONSOMMATION DU DOVX 24H00</div>
                    <div style="font-family:var(--font-num); font-size:14px; font-weight:800; margin-top:4px;">
                        <span class="tc-f">FUEL <span id="gBurnF">0</span></span> | <span class="tc-h">HEALTH <span id="gBurnH">0</span></span> | <span class="tc-r">REPAIR <span id="gBurnR">0</span></span> | <span class="tc-s">SUPPLY <span id="gBurnS">0</span></span>
                    </div>
                    <div style="text-align:right; margin-top:5px; font-size:11px; color:var(--purple); font-weight:bold;">CITY DOVX BURN: <span id="gCityBurn">0</span></div>
                </div>
            </div>
            <div class="kpi-grid" style="grid-template-columns: repeat(4, 1fr); margin-bottom:20px;">
                <div class="kpi-card"><div class="kc-title">TOTAL DIVISIONS</div><div class="kc-val" id="zTotalDivs">0</div></div>
                <div class="kpi-card"><div class="kc-title">IN FIGHT</div><div class="kc-val" id="zActiveDivs" style="color:var(--green)">0</div></div>
                <div class="kpi-card" style="align-items:center; justify-content:center;"><div class="pie-container"><div class="pie-chart" id="zPieChart"><span class="pie-val" id="zPieVal">0%</span></div></div></div>
                <div class="kpi-card"><div class="kc-title">TOTAL DOVX MINT</div><div class="kc-val" id="zTotalProd" style="color:var(--purple)">0</div></div>
            </div>
            <div class="zones-map" id="areaZones"></div>
        </div>

        <div id="viewEco" class="view-section">
            <div class="dashboard-header" style="border-left: 4px solid var(--orange)">
                <div><h2 class="page-h1">INVESTOR DASHBOARD</h2><div class="page-meta" id="ecoStatus">BUSINESS INTELLIGENCE</div></div>
                <div class="sys-clock"><span class="clock-copy"></span></div>
            </div>
            <div class="market-ticker" id="marketTicker"></div>
            <div class="kpi-grid eco" style="grid-template-columns: repeat(3, 1fr); gap:15px; margin-bottom:25px;">
                <div class="kpi-card"><div class="kc-title">UNIQUE WALLETS (USERS)</div><div class="kc-val-huge" style="color:var(--blue)" id="ecoWallets">0</div><div class="kc-sub">NFTHIVE SNAPSHOT</div></div>
                <div class="kpi-card"><div class="kc-title">NFT MARKET CAP</div><div class="kc-val" style="color:#fff" id="ecoNftCap">0</div><div class="kc-sub" id="ecoNftCapUsd">$0.00</div></div>
                <div class="kpi-card"><div class="kc-title">TOTAL ASSETS</div><div class="kc-val" id="ecoTVL">0</div><div class="kc-sub">CIRCULATING SUPPLY</div></div>
                <div class="kpi-card"><div class="kc-title">TOTAL SALES VOLUME</div><div class="kc-val" style="color:var(--yellow)" id="ecoSales">$0.00</div></div>
                <div class="kpi-card"><div class="kc-title">MARKET FEE</div><div class="kc-val" id="ecoFee">0%</div></div>
                <div class="kpi-card"><div class="kc-title">DAILY GDP (VALUE)</div><div class="kc-val" style="color:var(--green)" id="ecoGdpUsd">$0.00</div><div class="kc-sub" id="ecoGdpWax">0 WAX</div></div>
            </div>
            <div style="text-align:right; margin-bottom:15px; font-size:10px;"><a href="https://nfthive.io/collection/dovdivisions" target="_blank" style="color:#666; text-decoration:none;">SOURCE: NFTHIVE.IO ↗</a></div>
            <div class="data-panel" style="margin-bottom:25px;">
                <div class="dp-head"><span class="dp-title">FINANCIAL PROJECTIONS (REVENUE)</span></div>
                <div class="dt-grid dt-header" style="grid-template-columns: 200px 1fr 1fr;"><div class="cell">PERIOD</div><div class="cell c-right">REVENUE (WAX)</div><div class="cell c-right">REVENUE (USD)</div></div>
                <div id="projTable"></div>
            </div>
        </div>

        <div id="viewStats" class="view-section">
            <div class="dashboard-header" style="border-left: 4px solid var(--purple)">
                <div><h2 class="page-h1">FINANCIAL SUITE</h2><div class="page-meta">ADVANCED ANALYTICS</div></div>
                <div class="sys-clock"><span class="clock-copy"></span></div>
            </div>
            <div class="chart-controls">
                <button class="chart-btn active" onclick="switchChart('pnl')">PNL (NET PROFIT)</button>
                <button class="chart-btn" onclick="switchChart('scissors')">SCISSORS (REV vs COST)</button>
                <button class="chart-btn" onclick="switchChart('tvl')">TVL GROWTH</button>
            </div>
            <div id="chartContainer"><canvas id="analyticsChart"></canvas></div>
            <div id="financialInsight" class="analysis-box">Waiting for data...</div>
            <div class="data-panel">
                <div class="dp-head"><span class="dp-title">LOG HISTORY (EXTENDED)</span></div>
                <div class="dt-grid dt-header" style="grid-template-columns: 140px 60px 100px 100px 100px 100px;"><div class="cell">TIMESTAMP</div><div class="cell">TYPE</div><div class="cell c-right">REV (USD)</div><div class="cell c-right">COST (USD)</div><div class="cell c-right">NET (USD)</div><div class="cell c-right">ASSETS</div></div>
                <div id="logTable" class="stats-table-wrapper"></div>
            </div>
        </div>

        <div id="viewSim" class="view-section">
            <div class="dashboard-header" style="border-left: 4px solid var(--yellow)">
                <div><h2 class="page-h1" style="color:var(--yellow)">WAR ROOM</h2><div class="page-meta">GAP & CAPACITY PLANNING</div></div>
                <div class="sys-clock"><span class="clock-copy"></span></div>
            </div>
            <div style="margin-bottom:20px;">
                <button class="btn-yellow" style="width:250px; font-weight:bold;" onclick="runSimulation()">CALCULATE GAP & NEEDS</button>
                <span style="font-size:10px; color:#666; margin-left:10px;">BASED ON LIVE SCANNED DATA</span>
            </div>
            <div class="sim-grid">
                <div class="data-panel">
                    <div class="dp-head"><span class="dp-title" style="color:var(--blue)">CURRENT SUPPLY / DEMAND</span></div>
                    <div id="simGapList" style="padding:15px; font-family:var(--font-num);">Scan to Analyze...</div>
                </div>
                <div class="data-panel">
                    <div class="dp-head"><span class="dp-title" style="color:var(--green)">CONSTRUCTION ORDERS</span></div>
                    <div id="simBuildList" style="padding:15px; font-family:var(--font-num);">Scan to Analyze...</div>
                </div>
            </div>
            <div class="sim-result">
                <div id="simBalanceTable"></div>
                <div id="simRec" class="rec-box">AWAITING CALCULATION...</div>
            </div>
        </div>
    </main>
</div>

<div class="modal-overlay" id="dataRoomModal"><div class="modal-box" style="width:700px;">
    <img src="https://ipfs.io/ipfs/QmcR7QTbt2tYHxMZ8rsH45FxYU8fuHPCy7UeAguZW3QupE" class="dr-logo" alt="DOV Logo">
    <h3 style="text-align:center; color:#fff; margin-top:0;">DAWN OF VICTORY - INVESTOR DATA ROOM</h3>
    <div id="drContent"></div>
    <div style="text-align:right; margin-top:15px;"><button class="btn-ghost" onclick="closeModal('dataRoomModal')">CLOSE</button></div>
</div></div>

<div class="modal-overlay" id="auditModal"><div class="modal-box" style="width:800px;">
    <h3 style="margin-top:0; color:var(--red); border-bottom:1px solid #333; padding-bottom:10px;">AUDIT RAPPORT: ACTIFS INACTIFS</h3>
    <div style="height:400px; overflow-y:auto; margin-top:15px;">
        <div class="dt-grid dt-header" style="grid-template-columns: 1fr 1fr 1fr 100px 100px;">
            <div class="cell">WALLET (OWNER)</div>
            <div class="cell">TEMPLATE</div>
            <div class="cell">ARRÊTÉ LE</div>
            <div class="cell">INACTIF</div>
            <div class="cell c-center">ACTION</div>
        </div>
        <div id="auditList"></div>
    </div>
    <div style="text-align:right; margin-top:15px;"><button class="btn-ghost" onclick="closeModal('auditModal')">CLOSE</button></div>
</div></div>

<div class="modal-overlay" id="zoneDetailModal"><div class="modal-box" style="width:800px;">
    <h3 id="zdTitle" style="margin-top:0; color:#fff; border-bottom:1px solid #333; padding-bottom:10px;">ZONE DETAIL</h3>
    <div style="height:400px; overflow-y:auto; margin-top:15px;"><div id="zdList"></div></div>
    <div style="text-align:right; margin-top:15px;"><button class="btn-ghost" onclick="closeModal('zoneDetailModal')">CLOSE</button></div>
</div></div>

<script>
    // --- CONFIG ---
    const CONFIG_PRIX = { WAX_USD: 0.00751, DOVX_WAX: 0.00528553, DOVR_WAX: 0.00052051, DOVF_WAX: 0.00052051, DOVH_WAX: 0.00052051, DOVS_WAX: 0.00052051, PRIX_MOYEN_NFT_USD: 5 };
    const NFTHIVE_SNAPSHOT = { sales: "$954.1K", assets: "140 466", marketCap: "$883.3K", users: "8 334", fee: "6%" };
    const PROJECT_DATA = { links: [ { name: "Official Website", url: "https://dawnofvictory.io/" }, { name: "Whitepaper", url: "https://dawn-of-victory.gitbook.io/dov/" } ], markets: [ { name: "DOVX / WAX", url: "https://alcor.exchange/trade/dovx-dovvaultfort_wax-eosio.token" } ], contracts: [ "dovutilstake", "dovpvecontrl", "dawnfvictory" ] };

    const STORAGE_KEY = 'DOV_DATA_V318';
    const LOG_STORAGE_KEY = 'DOV_LOGS_V318';
    const getId = (id) => document.getElementById(id);
    const closeModal = (id) => getId(id).style.display = 'none';
    const switchView = (id) => { document.querySelectorAll('.view-section').forEach(e => e.classList.remove('active-view')); getId(id).classList.add('active-view'); };
    const fmt = (n) => n.toLocaleString('fr-FR', {maximumFractionDigits: 0});
    const fmtDec = (n) => n.toLocaleString('fr-FR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
    const fmtUsd = (n) => n.toLocaleString('en-US', {style:'currency', currency:'USD', minimumFractionDigits: 4});
    
    window.onerror = function(msg, url, line) { let errBanner = getId('error-banner'); errBanner.style.display = 'block'; errBanner.innerText = `CRITICAL ERROR: ${msg} (Line ${line}). Please Reset.`; return false; };
    function log(msg) { let c = getId('sysLog'); if(c) { let d = document.createElement("div"); d.className="log-entry"; d.innerHTML=`<span class="log-time">${new Date().toLocaleTimeString()}</span>${msg}`; c.prepend(d); } }

    const DEFAULT_DATA = {
        apiConfig: { 
            rpcNodes: [
                "https://wax.greymass.com", "https://wax.eosio.online", "https://wax.api.eosnation.io",
